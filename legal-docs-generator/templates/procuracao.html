<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Procuração Gerada</title>
    <style>
        .doc-container { margin: 20px; font-family: Arial, sans-serif }
        .button-group { margin: 20px 0; text-align: center }
        button { padding: 10px; margin: 0 5px; cursor: pointer }
        @media print {
            .button-group { display: none }
        }
    </style>
</head>
<body>
    <div class="button-group">
        <button onclick="window.print()">Imprimir Documento</button>
        <button onclick="exportToPDF()">Exportar PDF</button>
        <button onclick="exportToDOC()">Exportar DOC</button>
    </div>

    <div class="doc-container" id="documento-gerado">
        <h2>PROCURAÇÃO</h2>
        
        <p><strong>Outorgante:</strong> {{NOME_OUTORGANTE}}, {{ESTADO_CIVIL}}, {{PROFISSAO}}, 
        portador(a) do documento de identidade nº {{RG}} e CPF nº {{CPF}}, 
        residente e domiciliado(a) em {{ENDERECO_OUTORGANTE}}.</p>

        <p><strong>Outorgado:</strong> {{NOME_ADVOGADO}}, inscrito(a) na OAB sob nº {{OAB}}, 
        com escritório profissional em {{ENDERECO_ADVOGADO}}.</p>

        <p>Pelo presente instrumento particular, o(a) <strong>OUTORGANTE</strong> nomeia e constitui 
        como seu(ua) procurador(a) judicial e extrajudicial o(a) <strong>OUTORGADO(A)</strong>, 
        advogado(a) devidamente habilitado(a), conferindo-lhe os seguintes poderes:</p>

        <!-- Continue com o restante do modelo usando o mesmo padrão de placeholders -->
        
        <div class="footer">
            <p>{{CIDADE_ESTADO}}, {{DATA_COMPLETA}}.</p>
            <p>_________________________________________<br>
            <strong>Assinatura do(a) Outorgante</strong></p>
        </div>
    </div>

    <script>
        // Função para exportar para PDF
        function exportToPDF() {
            const element = document.getElementById('documento-gerado');
            html2pdf()
                .from(element)
                .save('procuracao.pdf');
        }

        // Função para exportar para DOC
        function exportToDOC() {
            const content = document.getElementById('documento-gerado').innerHTML;
            const converted = htmlDocx.asBlob(content);
            saveAs(converted, 'procuracao.doc');
        }
    </script>

    <!-- Dependências externas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html-docx-js@0.3.1/dist/html-docx.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<script>
    // Preenche os placeholders com os parâmetros da URL
    function populateTemplate() {
        const params = new URLSearchParams(window.location.search);
        
        // Mapeamento de parâmetros para elementos
        const mappings = {
            'NOME_OUTORGANTE': 'NOME_OUTORGANTE',
            'ESTADO_CIVIL': 'ESTADO_CIVIL',
            'PROFISSAO': 'PROFISSAO',
            'RG': 'RG',
            'CPF': 'CPF',
            'ENDERECO_OUTORGANTE': 'ENDERECO_OUTORGANTE',
            'NOME_ADVOGADO': 'NOME_ADVOGADO',
            'OAB': 'OAB',
            'ENDERECO_ADVOGADO': 'ENDERECO_ADVOGADO',
            'CIDADE_ESTADO': 'CIDADE_ESTADO',
            'DATA_COMPLETA': 'DATA_COMPLETA',
            'PODERES_ESPECIFICOS': 'PODERES_ESPECIFICOS'
        };

        for (const [param, placeholder] of Object.entries(mappings)) {
            const value = params.get(param) || '';
            document.body.innerHTML = document.body.innerHTML.replace(
                new RegExp(`{{${placeholder}}}`, 'g'), 
                value
            );
        }
    }

    // Executa ao carregar a página
    window.onload = populateTemplate;
</script>

</body>
</html>
